!function(a){"use strict";function t(t){t.find("article.format-gallery .gallery-pagination .pagination-link").off("click").on("click",function(){var t=a(this),i=t.parent().find("a"),n=t.data("images"),e=parseInt(t.data("index")),o=n.length;return t.hasClass("pagination-right")?(e+=1,e%=o):(0===e&&(e=o),e-=1),t.parents("article").find(".thumb").css("background-image","url("+n[e]+")"),i.data("index",e).attr("data-index",e),!1})}function i(i,n,e,o,d,r){a.ajax({url:wprotoEngineVars.ajaxurl,type:"POST",dataType:"json",data:{action:"wplab_albedo_ajax_query_posts",query_type:"load_more",atts:i.data("atts"),paged:o},beforeSend:function(){i.addClass("loading"),n.addClass("loading")},success:function(o){e.append(o.html),t(e),i.removeClass("loading"),n.removeClass("loading"),i.data("next-page",o.next_page),d>r&&i.hide(),a("article, li.article").fitVids()}})}window.albedo_blog_media_grid_init=function(){a(".shortcode-blog-media-grid").each(function(){var n=a(this),e=n.find(".blog-media-grid-posts").attr("id"),o=a("#"+e);t(o),n.find(".ajax-pagination-button").click(function(){if(n.hasClass("loading"))return!1;var t=a(this),e=parseInt(t.data("max-pages")),d=parseInt(t.data("next-page")),r=d+1;return t.data("next-page",r),i(t,n,o,d,r,e),!1});var d=n.find(".pagination.style-infinite");d.length&&o.waitForImages({waitForAll:!0,finished:function(){var t=d.offset().top-a(window).height();a(window).scroll(function(){var e=parseInt(d.data("max-pages")),r=parseInt(d.data("next-page")),s=r+1;a(window).scrollTop()>=t&&0==d.hasClass("loading")&&r<=e&&i(d,n,o,r,s,e)})}})})},window.albedo_blog_media_grid_init()}(window.jQuery);

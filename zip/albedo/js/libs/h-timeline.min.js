jQuery(document).ready(function(e){function t(t){t.each(function(){var i=e(this),a={};a.timelineWrapper=i.find(".events-wrapper"),a.eventsWrapper=a.timelineWrapper.children(".events"),a.fillingLine=a.eventsWrapper.children(".filling-line"),a.timelineEvents=a.eventsWrapper.find("a"),a.timelineDates=u(a.timelineEvents),a.eventsMinLapse=h(a.timelineDates),a.timelineNavigation=i.find(".timeline-navigation"),a.eventsContent=i.children(".events-content");var l=t.data("min-distance");o(a,l);var v=f(a,l);i.addClass("loaded"),a.timelineNavigation.on("click",".next",function(e){e.preventDefault(),n(a,v,"next",l)}),a.timelineNavigation.on("click",".prev",function(e){e.preventDefault(),n(a,v,"prev",l)}),a.eventsWrapper.on("click","a",function(t){t.preventDefault(),a.timelineEvents.removeClass("selected"),e(this).addClass("selected"),d(e(this)),s(e(this),a.fillingLine,v),p(e(this),a.eventsContent)}),a.eventsContent.on("swipeleft",function(){"mobile"==w()&&r(a,v,"next")}),a.eventsContent.on("swiperight",function(){"mobile"==w()&&r(a,v,"prev")}),e(document).keyup(function(e){"37"==e.which&&g(i.get(0))?r(a,v,"prev"):"39"==e.which&&g(i.get(0))&&r(a,v,"next")})})}function n(e,t,n,i){var r=v(e.eventsWrapper),a=Number(e.timelineWrapper.css("width").replace("px",""));"next"==n?l(e,r-a+i,a-t):l(e,r+a-i)}function r(e,t,n){var i=e.eventsContent.find(".selected");if(("next"==n?i.next():i.prev()).length>0){var r=e.eventsWrapper.find(".selected"),l="next"==n?r.parent("li").next("li").children("a"):r.parent("li").prev("li").children("a");s(l,e.fillingLine,t),p(l,e.eventsContent),l.addClass("selected"),r.removeClass("selected"),d(l),a(n,l,e)}}function a(e,t,n){var i=window.getComputedStyle(t.get(0),null),r=Number(i.getPropertyValue("left").replace("px","")),a=Number(n.timelineWrapper.css("width").replace("px","")),s=Number(n.eventsWrapper.css("width").replace("px","")),o=v(n.eventsWrapper);("next"==e&&r>a-o||"prev"==e&&r<-o)&&l(n,a/2-r,a-s)}function l(e,t,n){var i=e.eventsWrapper.get(0);t=t>0?0:t,c(i,"translateX",(t=void 0!==n&&t<=n?n:t)+"px"),0==t?e.timelineNavigation.find(".prev").addClass("inactive"):e.timelineNavigation.find(".prev").removeClass("inactive"),t==n?e.timelineNavigation.find(".next").addClass("inactive"):e.timelineNavigation.find(".next").removeClass("inactive")}function s(t,n,i){var r=window.getComputedStyle(t.get(0),null),a=e("body").hasClass("rtl")?r.getPropertyValue("right"):r.getPropertyValue("left"),l=r.getPropertyValue("width"),s=(a=Number(a.replace("px",""))+Number(l.replace("px",""))/2)/i;c(n.get(0),"scaleX",s)}function o(t,n){for(i=0;i<t.timelineDates.length;i++){var r=m(t.timelineDates[0],t.timelineDates[i]),a=Math.round(r/t.eventsMinLapse)+2;e("body").hasClass("rtl")?t.timelineEvents.eq(i).css("right",a*n+"px"):t.timelineEvents.eq(i).css("left",a*n+"px")}}function f(e,t){var n=m(e.timelineDates[0],e.timelineDates[e.timelineDates.length-1])/e.eventsMinLapse,i=(n=Math.round(n)+4)*t;return e.eventsWrapper.css("width",i+"px"),s(e.eventsWrapper.find("a.selected"),e.fillingLine,i),a("next",e.eventsWrapper.find("a.selected"),e),i}function p(e,t){var n=e.data("date"),i=t.find(".selected"),r=t.find('[data-date="'+n+'"]'),a=r.height();if(r.index()>i.index())var l="selected enter-right",s="leave-left";else var l="selected enter-left",s="leave-right";r.attr("class",l),i.attr("class",s).one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){i.removeClass("leave-right leave-left"),r.removeClass("enter-left enter-right")}),t.css("height",a+"px")}function d(e){e.parent("li").prevAll("li").children("a").addClass("older-event").end().end().nextAll("li").children("a").removeClass("older-event")}function v(e){var t=window.getComputedStyle(e.get(0),null),n=t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform");if(n.indexOf("(")>=0)i=(n=(n=(n=n.split("(")[1]).split(")")[0]).split(","))[4];else var i=0;return Number(i)}function c(e,t,n){e.style["-webkit-transform"]=t+"("+n+")",e.style["-moz-transform"]=t+"("+n+")",e.style["-ms-transform"]=t+"("+n+")",e.style["-o-transform"]=t+"("+n+")",e.style.transform=t+"("+n+")"}function u(t){var n=[];return t.each(function(){var t=e(this).data("date").split("T");if(t.length>1)var i=t[0].split("/"),r=t[1].split(":");else if(t[0].indexOf(":")>=0)var i=["2000","0","0"],r=t[0].split(":");else var i=t[0].split("/"),r=["0","0"];var a=new Date(i[2],i[1]-1,i[0],r[0],r[1]);n.push(a)}),n}function m(e,t){return Math.round(t-e)}function h(e){var t=[];for(i=1;i<e.length;i++){var n=m(e[i-1],e[i]);t.push(n)}return Math.min.apply(null,t)}function g(t){for(var n=t.offsetTop,i=e("body").hasClass("rtl")?t.offsetRight:t.offsetLeft,r=t.offsetWidth,a=t.offsetHeight;t.offsetParent;)n+=(t=t.offsetParent).offsetTop,e("body").hasClass("rtl")?i+=t.offsetRight:i+=t.offsetLeft;return n<window.pageYOffset+window.innerHeight&&i<window.pageXOffset+window.innerWidth&&n+a>window.pageYOffset&&i+r>window.pageXOffset}function w(){return window.getComputedStyle(document.querySelector(".horizontal-timeline"),"::before").getPropertyValue("content").replace(/'/g,"").replace(/"/g,"")}window.albedo_timeline_h_init=function(){e(".horizontal-timeline").each(function(){t(e(this))})},window.albedo_timeline_h_init()});

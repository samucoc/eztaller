!function(t,n){var o=function(t){return n.isString(t)?t.trim().length:0},a=function(t){var a=parseInt(t.data("map-zoom"))>0?parseInt(t.data("map-zoom")):4,e=t.find(".fw-map-canvas"),s=isNaN(parseInt(t.data("map-height")))?parseInt(.66*e.width()):parseInt(t.data("map-height")),r=t.data("locations"),c=t.data("map-type"),l=!!t.data("disable-scrolling"),d={zoom:a,center:"undefined"!==r&&r.length?i(r):new google.maps.LatLng(-34,150),mapTypeId:google.maps.MapTypeId[c],scrollwheel:l},g=new google.maps.LatLngBounds,p=new google.maps.Map(e.get(0),d);"undefined"!==r&&r.length&&r.forEach(function(t){gMapsCoords=new google.maps.LatLng(t.coordinates.lat,t.coordinates.lng);var a=new google.maps.Marker({position:gMapsCoords,map:p});if("undefined"!==t.icon&&t.icon.length&&a.setIcon(t.icon),g.extend(gMapsCoords),o(t.description)||o(t.title)||o(t.url)||o(t.thumb)){var i=n.template("<% function isNotEmptyString(str) { if (_.isString(str)) {\treturn str.trim().length;} return 0; }  %><div class='infowindow'><% if (isNotEmptyString(location.thumb)) { %><div class='infowindow-thump'><img src='<%= location.thumb %>' ></div> <% } %><div class='infowindow-content'><% if ( isNotEmptyString(location.url) || isNotEmptyString(location.title) ) { %><div class='infowindow-title'><a href='<%- location.url %>'><%- isNotEmptyString(location.title) ?  location.title : location.url  %></a></div><% } %><% if ( isNotEmptyString(location.description) ) { %><div class='infowindow-description'><%= location.description %></div><% } %></div></div>"),e=new google.maps.InfoWindow({content:i({location:t})});google.maps.event.addListener(a,"click",function(){e.open(p,a)})}}),r.length>1&&p.fitBounds(g);var m=google.maps.event.addListenerOnce(p,"zoom_changed",function(){p.getZoom()>16&&p.setZoom(16),google.maps.event.removeListener(m)});e.height(s),e.data("map",p)},i=function(t){var n,o,a,i=t.length,e=0,s=0,r=0;return t.forEach(function(t){var n=t.coordinates.lat*Math.PI/180,o=t.coordinates.lng*Math.PI/180,a=Math.cos(n)*Math.cos(o),i=Math.cos(n)*Math.sin(o),c=Math.sin(n);e+=a,s+=i,r+=c}),e/=i,s/=i,r/=i,n=Math.atan2(s,e),o=Math.sqrt(e*e+s*s),a=Math.atan2(r,o),{lng:180*n/Math.PI,lat:180*a/Math.PI}};t(document).ready(function(){t(".fw-map").each(function(){a(t(this))})})}(jQuery,_);
